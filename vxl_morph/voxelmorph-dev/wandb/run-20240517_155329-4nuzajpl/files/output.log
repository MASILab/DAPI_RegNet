------------------------------------------------------
Epoch: 0 Loss: -0.20109674229701877
Epoch 0 Val Loss: -0.23952642863150686
Epoch 0 Losses: [-0.22795703  0.02686029]
------------------------------------------------------
------------------------------------------------------
Epoch: 1 Loss: -0.23094640839925576
Epoch 1 Val Loss: -0.28179946718610066
Epoch 1 Losses: [-0.26216499  0.03121858]
------------------------------------------------------
------------------------------------------------------
Epoch: 2 Loss: -0.2617052077150448
Epoch 2 Val Loss: -0.29957199392322753
Epoch 2 Losses: [-0.29619672  0.03449151]
------------------------------------------------------
------------------------------------------------------
Epoch: 3 Loss: -0.27339389863790886
Epoch 3 Val Loss: -0.3042727744348632
Epoch 3 Losses: [-0.30791847  0.03452458]
------------------------------------------------------
------------------------------------------------------
Epoch: 4 Loss: -0.27620320946171684
Epoch 4 Val Loss: -0.3153604127272762
Epoch 4 Losses: [-0.3099353   0.03373209]
------------------------------------------------------
------------------------------------------------------
Epoch: 5 Loss: -0.28857429704560345
Epoch 5 Val Loss: -0.3245930592839116
Epoch 5 Losses: [-0.32225771  0.03368341]
------------------------------------------------------
------------------------------------------------------
Epoch: 6 Loss: -0.29153247358220996
Epoch 6 Val Loss: -0.29973200255636206
Epoch 6 Losses: [-0.32541425  0.03388177]
------------------------------------------------------
------------------------------------------------------
Epoch: 7 Loss: -0.2783250567620193
Epoch 7 Val Loss: -0.3219768168716293
Epoch 7 Losses: [-0.31244725  0.03412219]
------------------------------------------------------
------------------------------------------------------
Epoch: 8 Loss: -0.29091287684905065
Epoch 8 Val Loss: -0.32772663248962414
Epoch 8 Losses: [-0.32433868  0.0334258 ]
------------------------------------------------------
------------------------------------------------------
Epoch: 9 Loss: -0.2966933614892877
Epoch 9 Val Loss: -0.3268669297073395
Epoch 9 Losses: [-0.3299454   0.03325204]
------------------------------------------------------
------------------------------------------------------
Epoch: 10 Loss: -0.3021180130444564
Epoch 10 Val Loss: -0.3344823263828626
Epoch 10 Losses: [-0.33501657  0.03289855]
------------------------------------------------------
------------------------------------------------------
Epoch: 11 Loss: -0.2977229817347093
Epoch 11 Val Loss: -0.32990366015552475
Epoch 11 Losses: [-0.33091933  0.03319635]
------------------------------------------------------
------------------------------------------------------
Epoch: 12 Loss: -0.3023316047247096
Epoch 12 Val Loss: -0.3293795916116209
Epoch 12 Losses: [-0.33494844  0.03261683]
------------------------------------------------------
------------------------------------------------------
Epoch: 13 Loss: -0.30232262185641695
Epoch 13 Val Loss: -0.32379937188385693
Epoch 13 Losses: [-0.33487478  0.03255216]
------------------------------------------------------
------------------------------------------------------
Epoch: 14 Loss: -0.3065210910780089
Epoch 14 Val Loss: -0.33299573309831804
Epoch 14 Losses: [-0.33909149  0.0325704 ]
------------------------------------------------------
------------------------------------------------------
Epoch: 15 Loss: -0.29723679777476697
Epoch 15 Val Loss: -0.3252988315845351
Epoch 15 Losses: [-0.3295846   0.03234781]
------------------------------------------------------
------------------------------------------------------
Epoch: 16 Loss: -0.3028575348712149
Epoch 16 Val Loss: -0.3366924639270179
Epoch 16 Losses: [-0.33508205  0.03222452]
------------------------------------------------------
------------------------------------------------------
Epoch: 17 Loss: -0.31175736105674273
Epoch 17 Val Loss: -0.3382394168946174
Epoch 17 Losses: [-0.34369715  0.03193979]
------------------------------------------------------
------------------------------------------------------
Epoch: 18 Loss: -0.3084025920340509
Epoch 18 Val Loss: -0.3349995163833565
Epoch 18 Losses: [-0.34034161  0.03193902]
------------------------------------------------------
------------------------------------------------------
Epoch: 19 Loss: -0.3040683994722831
Epoch 19 Val Loss: -0.3253734164471879
Epoch 19 Losses: [-0.33585381  0.03178541]
------------------------------------------------------
------------------------------------------------------
Epoch: 20 Loss: -0.3006402321837165
Epoch 20 Val Loss: -0.32644831551087655
Epoch 20 Losses: [-0.33281371  0.03217348]
------------------------------------------------------
------------------------------------------------------
Epoch: 21 Loss: -0.3094491111961278
Epoch 21 Val Loss: -0.33881879054778713
Epoch 21 Losses: [-0.34132833  0.03187922]
------------------------------------------------------
------------------------------------------------------
Epoch: 22 Loss: -0.31191450186493075
Epoch 22 Val Loss: -0.33896211645295127
Epoch 22 Losses: [-0.34339518  0.03148068]
------------------------------------------------------
------------------------------------------------------
Epoch: 23 Loss: -0.3102322112430226
Epoch 23 Val Loss: -0.33924161806180564
Epoch 23 Losses: [-0.34186687  0.03163466]
------------------------------------------------------
------------------------------------------------------
Epoch: 24 Loss: -0.31438840844253185
Epoch 24 Val Loss: -0.33477276600386974
Epoch 24 Losses: [-0.34570189  0.03131348]
------------------------------------------------------
------------------------------------------------------
Epoch: 25 Loss: -0.31401192785535026
Epoch 25 Val Loss: -0.3124756613814883
Epoch 25 Losses: [-0.34568892  0.03167699]
------------------------------------------------------
------------------------------------------------------
Epoch: 26 Loss: -0.3120558477970429
Epoch 26 Val Loss: -0.33839204866644573
Epoch 26 Losses: [-0.34354176  0.03148591]
------------------------------------------------------
------------------------------------------------------
Epoch: 27 Loss: -0.3123811140527457
Epoch 27 Val Loss: -0.34047529931204085
Epoch 27 Losses: [-0.34421371  0.03183259]
------------------------------------------------------
------------------------------------------------------
Epoch: 28 Loss: -0.31159196007045314
Epoch 28 Val Loss: -0.33955864069613884
Epoch 28 Losses: [-0.34306262  0.03147066]
------------------------------------------------------
------------------------------------------------------
Epoch: 29 Loss: -0.31349767502639203
Epoch 29 Val Loss: -0.34334812309006985
Epoch 29 Losses: [-0.34494054  0.03144286]
------------------------------------------------------
------------------------------------------------------
Epoch: 30 Loss: -0.30694763312414614
Epoch 30 Val Loss: -0.34007600790924186
Epoch 30 Losses: [-0.33920692  0.03225929]
------------------------------------------------------
------------------------------------------------------
Epoch: 31 Loss: -0.3060921490901992
Epoch 31 Val Loss: -0.33183417783965463
Epoch 31 Losses: [-0.33742951  0.03133736]
------------------------------------------------------
------------------------------------------------------
Epoch: 32 Loss: -0.31098622201389564
Epoch 32 Val Loss: -0.33869334274006346
Epoch 32 Losses: [-0.34227533  0.03128911]
------------------------------------------------------
------------------------------------------------------
Epoch: 33 Loss: -0.29863210694936965
Epoch 33 Val Loss: -0.32462356129605263
Epoch 33 Losses: [-0.33088331  0.0322512 ]
------------------------------------------------------
------------------------------------------------------
Epoch: 34 Loss: -0.30917355989093903
Epoch 34 Val Loss: -0.3333472603053992
Epoch 34 Losses: [-0.34085214  0.03167858]
------------------------------------------------------
------------------------------------------------------
Epoch: 35 Loss: -0.12628080817041695
Epoch 35 Val Loss: -3.809866793568131e-07
Epoch 35 Losses: [-0.14833017  0.02204936]
------------------------------------------------------
------------------------------------------------------
Epoch: 36 Loss: 1.547062301847915e-06
Epoch 36 Val Loss: -3.8944092046981453e-07
Epoch 36 Losses: [-3.35118208e-08  1.58057413e-06]
------------------------------------------------------
------------------------------------------------------
Epoch: 37 Loss: 1.326973912401089e-06
Epoch 37 Val Loss: 6.870028583470787e-07
Epoch 37 Losses: [-2.79264315e-08  1.35490034e-06]
------------------------------------------------------
------------------------------------------------------
Epoch: 38 Loss: 8.196250967895332e-07
Epoch 38 Val Loss: 8.905957020916389e-07
Epoch 38 Losses: [-1.54922653e-08  8.35117362e-07]
------------------------------------------------------
------------------------------------------------------
Epoch: 39 Loss: 1.0820577812735258e-06
Epoch 39 Val Loss: -8.288073781973828e-08
Epoch 39 Losses: [-1.68407900e-08  1.09889858e-06]
------------------------------------------------------
------------------------------------------------------
Epoch: 40 Loss: 1.05126126561363e-06
Epoch 40 Val Loss: 1.7708756106391942e-06
Epoch 40 Losses: [-2.72503872e-08  1.07851167e-06]
------------------------------------------------------
------------------------------------------------------
Epoch: 41 Loss: 7.198303278196435e-07
Epoch 41 Val Loss: 8.389305509181832e-08
Epoch 41 Losses: [-7.77177865e-08  7.97548113e-07]
------------------------------------------------------
------------------------------------------------------
Epoch: 42 Loss: 8.127602558975448e-07
Epoch 42 Val Loss: 5.781740673972273e-07
Epoch 42 Losses: [-7.31708090e-08  8.85931062e-07]
------------------------------------------------------
------------------------------------------------------
Epoch: 43 Loss: 7.45843687004506e-07
Epoch 43 Val Loss: 9.191261344944155e-07
Epoch 43 Losses: [-6.64070600e-08  8.12250754e-07]
------------------------------------------------------
------------------------------------------------------
Epoch: 44 Loss: 1.2105048289784497e-06
Epoch 44 Val Loss: 1.381504654484196e-06
Epoch 44 Losses: [-7.82216397e-08  1.28872646e-06]
------------------------------------------------------
Traceback (most recent call last):
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/PIL/ImageFile.py", line 536, in _save
    fh = fp.fileno()
         ^^^^^^^^^
AttributeError: '_idat' object has no attribute 'fileno'
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/nfs2/forGaurav/yesbackup/DAPI_RegSegNet/vxl_morph/voxelmorph-dev/008_train_on_other_devices.py", line 149, in <module>
    plt.savefig(os.path.join(epoch_dir, f'pair_{i}.png'))  # Save the plot as an image
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/matplotlib/pyplot.py", line 1119, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/matplotlib/figure.py", line 3390, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2193, in print_figure
    result = print_method(
             ^^^^^^^^^^^^^
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2043, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                 ^^^^^
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 497, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 446, in _print_pil
    mpl.image.imsave(
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/matplotlib/image.py", line 1656, in imsave
    image.save(fname, **pil_kwargs)
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/PIL/Image.py", line 2439, in save
    save_handler(self, fp, filename)
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/PIL/PngImagePlugin.py", line 1402, in _save
    ImageFile._save(im, _idat(fp, chunk), [("zip", (0, 0) + im.size, 0, rawmode)])
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/PIL/ImageFile.py", line 540, in _save
    _encode_tile(im, fp, tile, bufsize, None, exc)
  File "/home/local/VANDERBILT/rudravg/miniconda3/envs/dapi_reg/lib/python3.12/site-packages/PIL/ImageFile.py", line 559, in _encode_tile
    errcode, data = encoder.encode(bufsize)[1:]
                    ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt